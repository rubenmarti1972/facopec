<header class="site-header" role="banner">
  <div class="container site-header__inner">
    <a
      class="site-header__brand"
      routerLink="/"
      aria-label="Fundación Afrocolombiana Profe en Casa - Inicio"
      data-strapi-collection="global"
      data-strapi-field="brand"
    >
      <span class="site-header__logo" aria-hidden="true">
        <img src="assets/logo.png" alt="Logo de FACOPEC" loading="lazy" />
      </span>
      <span class="site-header__titles">
        <span class="site-header__title">Fundación Afrocolombiana Profe en Casa</span>
        <span class="site-header__subtitle">Educación, cultura y fe en Valle del Cauca</span>
      </span>
    </a>

    <button
      class="site-header__toggle"
      type="button"
      (click)="toggleMenu()"
      [attr.aria-expanded]="isMenuOpen"
      aria-controls="primary-navigation"
    >
      <span class="sr-only">{{ isMenuOpen ? 'Cerrar menú' : 'Abrir menú' }}</span>
      <span class="site-header__toggle-line" aria-hidden="true"></span>
      <span class="site-header__toggle-line" aria-hidden="true"></span>
      <span class="site-header__toggle-line" aria-hidden="true"></span>
    </button>

    <nav class="site-nav" aria-label="Navegación principal" [class.site-nav--open]="isMenuOpen" id="primary-navigation">
      <ul class="site-nav__list" [class.site-nav__list--open]="isMenuOpen">
        <li
          class="site-nav__item"
          *ngFor="let link of navLinks; let i = index"
          [class.site-nav__item--has-children]="link.children?.length"
          [class.site-nav__item--open]="isDropdownOpen(i)"
        >
          <a
            class="site-nav__link"
            *ngIf="!link.children?.length"
            [routerLink]="link.routerLink || null"
            [href]="link.href || null"
            routerLinkActive="active"
            [routerLinkActiveOptions]="link.exact ? { exact: true } : { exact: false }"
            [attr.data-strapi-uid]="link.dataStrapiUid"
            (click)="closeMenu()"
          >
            {{ link.label }}
          </a>

          <a
            *ngIf="link.children?.length"
            class="site-nav__link site-nav__link--trigger"
            [routerLink]="link.routerLink || null"
            [href]="link.href || null"
            routerLinkActive="active"
            [routerLinkActiveOptions]="link.exact ? { exact: true } : { exact: false }"
            [attr.aria-haspopup]="'true'"
            [attr.data-strapi-uid]="link.dataStrapiUid"
            [attr.aria-expanded]="isDropdownOpen(i)"
            (click)="toggleDropdown(i, $event)"
          >
            {{ link.label }}
            <span class="site-nav__caret" aria-hidden="true">▾</span>
          </a>

          <div class="site-nav__panel" *ngIf="link.children?.length" [class.site-nav__panel--open]="isDropdownOpen(i)">
            <div class="site-nav__group" *ngFor="let group of link.children" [attr.data-strapi-uid]="group.dataStrapiUid">
              <p class="site-nav__group-title">{{ group.title }}</p>
              <a
                *ngFor="let child of group.items"
                class="site-nav__sublink"
                [href]="child.href"
                target="_blank"
                rel="noopener"
                [attr.data-strapi-uid]="child.dataStrapiUid"
                (click)="closeMenu()"
              >
                {{ child.label }}
              </a>
            </div>
          </div>
        </li>
        <li class="site-nav__item site-nav__item--cta">
          <a routerLink="/donate" class="btn btn-donate" data-strapi-uid="navigation.donate" (click)="closeMenu()">Donar</a>
        </li>
      </ul>
    </nav>
  </div>
</header>
